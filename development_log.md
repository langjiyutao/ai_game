# 《字色快打！》游戏开发记录

## 项目概述
《字色快打！》是一款基于JavaScript开发的Web反应类游戏，挑战玩家的反应速度和颜色识别能力。游戏采用纯原生JavaScript实现，无框架依赖，具有响应式设计，支持多种设备。

## 核心玩法
- **判定规则**：当按钮的字体颜色与文字内容所指的颜色不一致时，玩家需要点击该按钮得分
- **连击奖励**：连续正确点击可累积连击数，达到特定连击数时触发奖励效果
- **错误惩罚**：点击错误会重置连击数并减少剩余时间

## 开发过程

### 1. 初始设计与规划
- 根据设计文档确定了游戏的核心玩法和规则
- 规划了三种难度级别：基础难度、进阶难度和地狱难度
- 设计了连击奖励系统和成就系统
- 确定了游戏的美术风格：Q版萌系，色彩饱和度高，元素带圆润边角

### 2. 文件结构创建
- 创建了基本的项目文件结构：
  - index.html：游戏的HTML结构
  - styles.css：游戏的样式表
  - game.js：游戏的核心逻辑
  - README.md：项目说明文档
- 设置了Git版本控制

### 3. HTML结构实现
- 创建了多个游戏界面：
  - 主菜单界面
  - 规则说明界面
  - 难度选择界面
  - 游戏界面
  - 结果界面
  - 成就界面
- 为音效资源预留了位置
- 实现了响应式布局，适配不同设备

### 4. CSS样式开发
- 实现了游戏的视觉风格，采用卡通美术风格
- 使用鲜艳的颜色和圆润的边角，增强游戏的趣味性
- 添加了多种动画效果：
  - 按钮点击效果
  - 连击显示动画
  - 奖励效果动画
  - 错误抖动效果
- 实现了响应式设计，确保在手机和PC上都有良好的体验

### 5. JavaScript核心逻辑实现
- 实现了游戏的核心判定逻辑：颜色≠文字时为正确
- 开发了难度系统，包括三个难度级别：
  - 基础难度：3个选项，5秒限时，颜色池仅「红、黄」
  - 进阶难度：5个选项，3秒限时，颜色池扩展「蓝、绿」
  - 地狱难度：选项混入「粉、紫」等相似色+干扰项
- 实现了连击奖励系统：
  - 5连击：3秒内分数×2
  - 10连击：下轮额外+2秒答题时间
  - 15连击：临时"错误免疫"（1次错误不计惩罚）
- 开发了成就系统，包括多种成就：
  - 连击王者：单次达成15连击
  - 速通达人：1分钟内通关3关
  - 不屈战神：连续错误5次仍通关
- 实现了本地存储功能，保存游戏进度和成就

### 6. 版本控制与部署
- 使用Git进行版本控制
- 完成初始版本的提交和推送
- 准备后续部署到GitHub Pages或其他Web服务器

## 技术实现细节

### 核心游戏逻辑
游戏的核心判定逻辑是检查按钮的字体颜色是否与文字内容所指的颜色不一致：
```javascript
// 核心判定逻辑
if (targetColor !== gameConfig.textMap[targetText]) {
    // 正确：颜色≠文字
    handleCorrectAnswer(button);
} else {
    // 错误：颜色=文字
    handleWrongAnswer(button);
}
```

### 难度系统
游戏根据不同难度级别调整颜色池、选项数量和时间限制：
```javascript
// 难度设置
difficulties: {
    easy: {
        colors: ['red', 'yellow'],
        texts: ['红', '黄'],
        optionsCount: 3,
        timeLimit: 5,
        targetScore: 100
    },
    medium: {
        colors: ['red', 'yellow', 'blue', 'green'],
        texts: ['红', '黄', '蓝', '绿'],
        optionsCount: 5,
        timeLimit: 3,
        targetScore: 200
    },
    hard: {
        colors: ['red', 'yellow', 'blue', 'green', 'purple', 'pink'],
        texts: ['红', '黄', '蓝', '绿', '紫', '粉', '彩虹'],
        optionsCount: 5,
        timeLimit: 2,
        targetScore: 300
    }
}
```

### 连击奖励系统
游戏实现了连击奖励系统，达到特定连击数时触发不同奖励：
```javascript
// 连击奖励配置
comboRewards: {
    5: { type: 'doubleScore', duration: 3000, message: '双倍分数！' },
    10: { type: 'extraTime', value: 2, message: '+2秒时间！' },
    15: { type: 'immunity', value: 1, message: '错误免疫！' }
}
```

### 本地存储
游戏使用localStorage保存玩家的游戏进度和成就：
```javascript
// 保存游戏数据
function saveGameData() {
    const dataToSave = {
        unlockedDifficulties: gameState.unlockedDifficulties,
        unlockedAchievements: gameState.unlockedAchievements,
        maxCombo: gameState.maxCombo,
        clearedLevels: gameState.clearedLevels
    };
    localStorage.setItem('colorWordGame', JSON.stringify(dataToSave));
}
```

## 后续计划

### 近期优化
- 添加游戏音效和背景音乐
- 创建游戏吉祥物图像资源
- 优化游戏性能，特别是在低端设备上

### 未来功能
- 添加更多难度级别
- 实现双人对战模式
- 添加更多视觉和音效反馈
- 支持更多平台和设备
- 实现在线排行榜功能

## 更新记录

### 2025-05-26 基础难度模式改进
- 修改了基础难度的游戏设计，增加了提示词功能
- 基础难度下，游戏会先显示提示词，如"请点击红色的'黄'字"
- 然后给出3个选项，其中只有1个是正确的（颜色为红色，文字为"黄"），其他选项都是错误的
- 这种设计更适合初学者，降低了游戏的入门门槛
- 中级和高级难度仍保持原有的判断规则（颜色≠文字为正确）
## 总结
《字色快打！》游戏的初始版本已经完成，包含了核心游戏逻辑、三种难度级别、连击奖励系统和成就系统。游戏采用纯原生JavaScript实现，无框架依赖，具有响应式设计，支持多种设备。后续将继续优化游戏体验，添加更多功能。
### 2025-05-26 游戏时间调整
- 延长了各难度级别的初始时间，提升游戏体验
- 基础难度：5秒 → 10秒
- 中级难度：3秒 → 8秒
- 高级难度：2秒 → 5秒
- 这样的调整让玩家有更充足的时间来思考和反应，特别是对于初次接触游戏的玩家
### 2025-05-26 添加反馈提示功能
- 增加了点击选项后的视觉反馈功能
- 正确选择时显示"正确！"提示，并高亮显示选项（绿色）
- 错误选择时显示"错误！"提示，并高亮显示选项（红色）
- 添加了动画效果，使反馈更加明显
- 这一改进增强了游戏的用户体验，让玩家能够清楚地知道自己的选择是否正确
### 2025-05-26 添加游戏结束音效
- 创建了sounds目录，用于存放游戏音效文件
- 将winmusic.ogg移动到sounds目录下
- 在游戏结束时播放胜利音效
- 优化了音效资源的组织结构，为后续添加更多音效做准备
### 2025-05-26 更新游戏音效
- 应用了新增的4个音效文件：
  - click.ogg：按钮点击音效
  - correct.ogg：答案正确音效
  - wrong.ogg：答案错误音效
  - levelup.ogg：升级音效
- 更新了HTML中的音效引用，将mp3格式替换为实际的ogg格式
- 为所有按钮点击事件添加了点击音效
- 优化了音效播放逻辑，增强游戏的听觉反馈
### 2025-05-26 添加调试模式
- 增加了调试模式功能，在该模式下无论点击什么选项都会被判定为正确
- 使用Ctrl+D快捷键切换调试模式
- 添加了调试模式状态提示，显示当前是否开启调试模式
- 调试模式适用于所有难度级别
- 这个功能对于测试游戏功能和展示游戏特性非常有用
### 2025-05-26 修复游戏结束后返回主菜单白屏问题
- 修复了游戏结束后点击"返回主菜单"按钮导致白屏的问题
- 问题原因：计时器没有被正确清除，导致在切换屏幕后仍在运行
- 解决方案：
  - 在`showScreen`函数中添加了计时器清除逻辑，确保切换屏幕时停止所有计时器
  - 在`endGame`函数中增强了计时器清除逻辑，添加了空值检查和重置
  - 这些修改确保了在游戏的任何状态下切换屏幕都不会出现计时器冲突
### 2025-05-26 修复屏幕切换错误
- 修复了返回主菜单功能的错误
- 问题：使用了错误的屏幕标识符`'main-menu'`而不是`'mainMenu'`
- 修改了所有`showScreen('main-menu')`调用为`showScreen('mainMenu')`
- 这个修复解决了游戏结束后返回主菜单可能出现的白屏问题
- 确保了屏幕切换的一致性和可靠性
### 2025-05-26 增加游戏选项数量
- 将游戏选项数量从3个增加到6个
- 修改了所有难度级别的选项数量配置
- 调整了选项按钮的样式，使其更适合显示更多选项：
  - 减小了按钮尺寸（从100px×100px减小到80px×80px）
  - 减小了字体大小（从2.5rem减小到2.2rem）
  - 在移动设备上进一步减小按钮尺寸（70px×70px）
- 添加了顶部边距，使布局更加合理
- 这些修改增加了游戏的挑战性和趣味性
### 2025-05-26 添加连击指示器
- 增加了连击指示器功能，直观显示当前连击数
- 连击指示器设计为圆形，位于游戏界面右上角
- 当连击数为0时，指示器隐藏；当连击数大于0时，指示器显示
- 当连击数达到里程碑（5、10、15等）时，指示器会有脉动动画效果
- 添加了平滑的过渡动画，使指示器的显示和隐藏更加自然
- 这个功能增强了游戏的视觉反馈，让玩家更容易关注当前连击状态
### 2025-05-26 添加背景音乐
- 添加了背景音乐功能，使用sounds/bgm.mp3作为游戏背景音乐
- 在游戏开始时自动播放背景音乐，并设置为循环播放
- 在游戏结束或退出游戏界面时自动停止背景音乐
- 添加了音乐控制函数：
  - `playBackgroundMusic()`：播放背景音乐，设置音量为0.5
  - `stopBackgroundMusic()`：停止背景音乐并重置进度
- 优化了屏幕切换逻辑，确保在离开游戏界面时停止背景音乐
- 背景音乐的添加增强了游戏的沉浸感和氛围
### 2025-05-26 优化结算界面按钮显示
- 修改了结算界面按钮的显示逻辑，添加1秒延迟
- 在游戏结束后，结算界面的按钮会在1秒后才淡入显示
- 添加了平滑的淡入和上移动画效果
- 这个改进可以防止玩家因操作惯性而误触按钮
- 同时也增强了结算界面的视觉体验，使界面切换更加流畅
### 2025-05-26 进一步优化结算界面按钮
- 修复了结算界面按钮在视觉隐藏但仍可点击的问题
- 添加了`pointer-events: none`属性，完全禁用按钮的点击功能
- 只有在1秒延迟后，按钮才会同时变为可见和可点击
- 这个修复确保了玩家不会在游戏刚结束时因操作惯性误触按钮
- 提高了游戏的用户体验和操作流畅度
### 2025-05-26 优化按钮文字可读性
- 为按钮文字添加阴影效果，提高文字清晰度
- 对所有按钮文字添加了基础阴影：`text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5)`
- 针对不同颜色的文字设置了不同强度的阴影效果：
  - 黄色文字：最强阴影效果，确保在白色背景上清晰可见
  - 粉色文字：较强阴影效果
  - 其他颜色：适中阴影效果
- 这个改进解决了黄色文字在白色背景上不够清晰的问题
- 提高了游戏的可读性和视觉体验
### 2025-05-26 增加结算界面统计数据
- 在结算界面增加了更多统计数据：
  - 正确率：显示玩家的点击准确度
  - 最快反应时间：记录玩家最快的一次正确点击
  - 平均反应时间：计算所有正确点击的平均时间
- 添加了相关数据的跟踪机制：
  - 记录总点击次数和正确点击次数
  - 记录每次正确点击的反应时间
  - 在每轮开始时记录时间戳
- 优化了结算界面的样式，使统计数据更加清晰
- 更新了分享功能，在分享文本中包含正确率和平均反应时间
- 这些统计数据让玩家能更全面地了解自己的游戏表现
### 2025-05-26 更换游戏字体
- 添加了马善政字体(MaShanZheng-Regular.ttf)到游戏中
- 使用@font-face在CSS中定义了字体
- 将游戏中选项按钮的字体更改为马善政字体
- 将提示文字的字体也更改为马善政字体，保持风格一致
- 马善政字体是一种具有中国传统书法风格的字体，增强了游戏的文化氛围
- 这个字体更改使游戏界面更加美观，提升了整体视觉体验
### 2025-05-26 重构游戏难度系统
- 移除了难度选择界面，简化了游戏流程
- 实现了动态难度调整系统，根据玩家进度自动增加难度
- 修改了游戏关卡进度逻辑：
  - 第1关：红色和黄色，4个选项
  - 第2关：增加蓝色，5个选项
  - 第3关：增加绿色，5个选项
  - 第4关：增加紫色，6个选项
  - 第5关：增加粉色，6个选项
  - 更高关卡：逐渐增加选项数量，最多8个
- 调整了游戏模式：
  - 第1关使用基础模式（指定颜色和文字）
  - 第2关及以上使用高级模式（点击颜色与文字不一致的选项）
- 增加了每关升级后的时间奖励（+5秒）
- 简化了游戏数据存储，移除了难度相关的数据
- 这个改进使游戏流程更加流畅，难度曲线更加平滑
### 2025-05-26 优化选项排版布局
- 将选项容器从Flex布局改为Grid布局，实现更均衡的选项排列
- 添加了`adjustOptionsContainerColumns`函数，根据选项数量动态调整列数：
  - 4个选项：2×2布局
  - 5个选项：3-2布局（第一行3个，第二行2个）
  - 6个选项：3×2布局
  - 7个选项：4-3布局
  - 8个选项：4×2布局
- 修改了选项生成函数，在添加选项前先调整容器列数
- 优化了移动设备上的选项布局，减小了间距
- 这个改进解决了选项排版不均衡的问题，使界面更加美观
### 2025-05-26 清理未使用代码
- 删除了与难度选择相关的不再使用的代码：
  - 移除了`difficulties`配置对象
  - 移除了难度选择界面相关的DOM引用
  - 删除了`generateEasyModeRound`和`generateNormalModeRound`函数
  - 删除了`checkDifficultyUnlock`函数
- 从HTML中移除了难度选择界面
- 这次清理提高了代码的可维护性，减少了不必要的复杂度
### 2025-05-26 简化关卡系统
- 将游戏关卡缩减为3个关卡：
  - 第1关：红色和黄色，4个选项（基础模式）
  - 第2关：所有6种颜色，6个选项（高级模式）
  - 第3关：所有6种颜色，9个选项（高级模式）
- 调整了关卡分数阈值：
  - 第1关到第2关：100分
  - 第2关到第3关：300分
  - 第3关之后：每关+200分
- 简化了`adjustOptionsContainerColumns`函数，只保留需要的布局配置
- 这个改进使游戏难度曲线更加明确，玩家体验更加流畅
### 2025-05-26 改进游戏玩法系统
- 将两种游戏模式改为两种随机出现的玩法：
  - 玩法一（基础模式）：选择提示中对应的选项
  - 玩法二（高级模式）：选择颜色与文字不同的选项
- 调整了玩法出现规则：
  - 第1关：只有玩法一（基础模式）
  - 第2关及以上：两种玩法随机出现
- 在提示词中突出显示关键词：
  - 玩法一突出显示"对应"
  - 玩法二突出显示"不同"
- 重构了按钮点击处理逻辑，使用统一的处理函数
- 添加了CSS样式使高亮关键词更加醒目
- 这个改进增加了游戏的变化性，提高了游戏的趣味性
### 2025-05-26 添加得分特效
- 增加了得分弹出并掉落的视觉特效
- 当玩家选择正确选项时，会在按钮处显示得分特效
- 特效具有模拟重力的动画效果：
  - 初始阶段：从按钮中心向上弹出
  - 中间阶段：达到最高点后开始下落
  - 最终阶段：逐渐加速下落并淡出
- 每个得分特效有随机的水平偏移，增加视觉多样性
- 使用CSS动画实现流畅的物理效果
- 这个特效增强了游戏的视觉反馈，提升了游戏体验
### 2025-05-26 改进得分特效
- 重写了得分特效的实现，使用JavaScript模拟物理引擎
- 新的得分特效具有更真实的物理行为：
  - 随机向上方抛出，带有随机的水平速度
  - 受重力影响形成抛物线轨迹
  - 应用摩擦力使水平运动逐渐减慢
  - 逐渐降低透明度直至消失
- 使用requestAnimationFrame实现平滑动画
- 移除了原来基于CSS动画的实现
- 这个改进使得得分特效更加生动和自然，增强了游戏的视觉体验
### 2025-05-26 添加错误特效
- 为错误选择添加了与得分特效类似的视觉反馈
- 当玩家选择错误选项时，会显示一个❌符号的特效
- 错误特效使用红色显示，与得分特效的黄色形成对比
- 错误特效也使用相同的物理动画效果，从按钮处抛出并落下
- 修改了`showScoreEffect`函数，使其能够处理不同类型的特效
- 这个改进使游戏对错误操作提供了更明显的视觉反馈，增强了游戏体验
### 2025-05-26 添加主菜单背景音乐
- 添加了homePage.mp3作为主菜单背景音乐
- 实现了音乐系统的完整管理：
  - 主菜单播放homePage.mp3
  - 游戏中播放bgm.mp3
  - 在不同界面间切换时自动管理音乐播放状态
- 添加了`playHomeMusic`函数用于播放主菜单音乐
- 修改了`showScreen`函数，根据当前屏幕和目标屏幕自动切换音乐
- 优化了`playBackgroundMusic`函数，确保切换到游戏音乐时停止主菜单音乐
- 游戏启动时自动播放主菜单音乐，增强了游戏的氛围感
### 2025-05-26 优化主菜单背景音乐
- 改进了主菜单音乐的播放逻辑：
  - 页面加载时立即播放主菜单音乐
  - 在任何非游戏页面（主菜单、规则、成就、结果页面）都播放主菜单音乐
  - 只有在游戏页面才播放游戏背景音乐
- 优化了`playHomeMusic`函数，避免重复播放已经在播放的音乐
- 简化了`showScreen`函数中的音乐切换逻辑
- 这个改进使音乐系统更加一致，为用户提供更好的音频体验
### 2025-05-27 添加游戏背景图片
- 添加了背景图片，替换原来的渐变背景
- 使用`background-size: cover`确保背景图片完全覆盖屏幕，不会拉伸或留下空白
- 使用`background-position: center center`确保背景图片居中显示
- 使用`fixed`属性确保背景图片在滚动时保持固定
- 增加了游戏容器的半透明效果，使背景图片可以隐约可见
- 添加了模糊效果(backdrop-filter: blur)，增强视觉体验
- 提高了游戏容器的z-index，确保它显示在背景之上
- 这个改进增强了游戏的视觉吸引力，提供了更加沉浸的游戏体验
### 2025-05-27 将背景图片添加到游戏区域
- 将背景图片从整个页面移到游戏区域内部
- 修改了`.game-area`样式，添加背景图片
- 使用`background-size: cover`确保背景图片完全覆盖游戏区域
- 添加了圆角边框，使背景图片与游戏界面风格一致
- 增强了提示容器和选项容器的样式：
  - 为提示容器和选项容器添加半透明背景
  - 添加圆角和阴影效果，使其在背景图片上更加突出
- 这个改进使游戏界面更加美观，同时保持了良好的可读性
### 2025-05-27 更新游戏界面设计
- 将背景图片从game-area移动到game-container，使其成为整个游戏的背景
- 将主菜单按钮（开始游戏、游戏规则、成就）的背景更改为whiteBtn.png图片
- 优化了按钮样式：
  - 使用背景图片替代纯色背景
  - 调整了按钮的大小、颜色和悬停效果
  - 设置了最小宽度，确保按钮显示一致
- 为所有屏幕添加了半透明背景，提高文字可读性
- 移除了不必要的阴影和边框效果
- 这些改进使游戏界面更加美观，提供了更好的视觉体验
### 2025-05-27 更新游戏界面字体
- 将游戏界面中的得分、连击、时间和关卡的字体改为Uranus像素字体
- 添加了@font-face规则，引入Uranus_Pixel_11Px.ttf字体
- 更新了以下元素的字体：
  - 游戏头部信息栏（得分、连击、时间、关卡）
  - 连击指示器
  - 倒计时数字
- 这个改进使游戏界面更加统一，增强了像素游戏的视觉风格
### 2025-05-27 更新选项按钮样式
- 将选项按钮的背景替换为optionBtn.png图片
- 移除了原有的边框和圆角样式
- 使用background-size: 100% 100%确保图片完全覆盖按钮区域
- 更新了正确和错误状态的视觉效果：
  - 使用filter: drop-shadow替代原来的背景色和边框变化
  - 为正确选项添加青色阴影效果
  - 为错误选项添加红色阴影效果
- 这个改进使选项按钮的外观更加美观，与游戏的整体设计风格更加协调
### 2025-05-27 调整连击提示器的显示层级
- 将连击提示器的定位方式从`position: fixed`改为`position: absolute`
- 这个修改确保连击提示器始终显示在游戏窗口内部，而不是相对于整个浏览器窗口定位
- 修复了在某些屏幕尺寸下连击提示器可能超出游戏容器范围的问题
- 提高了游戏界面的一致性和美观度
